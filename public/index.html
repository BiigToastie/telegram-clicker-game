<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="Content-Security-Policy" content="default-src * 'self' 'unsafe-inline' 'unsafe-eval' data: telegram.org *.telegram.org">
    <title>Clicker Game</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="game.js"></script>
    <audio id="bgMusic" loop>
        <source src="music/background.mp3" type="audio/mp3">
    </audio>
    <style>
        /* All existing styles remain unchanged */
        /* ... */
    </style>
</head>
<body>
    <!-- All existing HTML content remains unchanged until the island-overlay -->

    <!-- Insel Overlay -->
    <div class="island-overlay" id="islandOverlay">
        <button class="back-button" id="backButton">↩️ Zurück</button>
        <div class="island-resources">
            <div class="resource-item">
                <span>🌿 Pflanzen:</span>
                <span id="plantsCount">0</span>
            </div>
            <div class="resource-item">
                <span>💰 Credits:</span>
                <span id="islandCredits">0</span>
            </div>
            <div class="resource-item">
                <span>📦 Lager:</span>
                <span id="storageSpace">0/100</span>
            </div>
        </div>
        <div class="island-grid">
            <!-- Plantage -->
            <div class="building-card" id="plantation">
                <div class="building-icon">🌱</div>
                <div class="building-info">
                    <div class="building-name">Plantage</div>
                    <div class="building-cost">100 Credits</div>
    </div>
            </div>
            <!-- Lagerhaus -->
            <div class="building-card" id="storage">
                <div class="building-icon">🏠</div>
                <div class="building-info">
                    <div class="building-name">Lagerhaus</div>
                    <div class="building-cost">250 Credits</div>
    </div>
            </div>
            <!-- Verkaufsstand -->
            <div class="building-card" id="shop">
                <div class="building-icon">🏪</div>
                <div class="building-info">
                    <div class="building-name">Verkaufsstand</div>
                    <div class="building-cost">500 Credits</div>
        </div>
            </div>
        </div>
    </div>

    <!-- All existing HTML content remains unchanged -->

    <script>
        // All existing JavaScript code remains unchanged
        
        // Insel Spielzustand
        let islandState = {
            credits: 0,
            plants: 0,
            storage: {
                capacity: 100,
                used: 0
            },
            buildings: {
                plantations: 0,
                storages: 0,
                shops: 0
            },
            multipliers: {
                production: 1,
                storage: 1,
                sales: 1
            }
        };

        // Event Listener für Gebäude
        document.getElementById('plantation').addEventListener('click', () => {
            if (islandState.credits >= 100) {
                islandState.credits -= 100;
                islandState.buildings.plantations++;
                updateIslandDisplay();
                showToast('🌱 Neue Plantage gebaut!');
            } else {
                showToast('❌ Nicht genug Credits!', 'error');
            }
        });

        // Automatische Produktion
        setInterval(() => {
            if (islandState.buildings.plantations > 0) {
                const production = islandState.buildings.plantations * islandState.multipliers.production;
                if (islandState.storage.used + production <= islandState.storage.capacity) {
                    islandState.plants += production;
                    islandState.storage.used += production;
                    updateIslandDisplay();
                }
            }
        }, 1000);

        function updateIslandDisplay() {
            document.getElementById('plantsCount').textContent = Math.floor(islandState.plants);
            document.getElementById('islandCredits').textContent = Math.floor(islandState.credits);
            document.getElementById('storageSpace').textContent = 
                `${Math.floor(islandState.storage.used)}/${islandState.storage.capacity}`;
        }
    </script>
</body>
</html>